---
import BaseLayout from "./BaseLayout.astro";
import type { CollectionEntry } from "astro:content";

interface Props {
    post: CollectionEntry<"posts">;
}

const { post } = Astro.props;
const { title, description, date, author, category, tags, featured } =
    post.data;

// Format the date
const formattedDate = date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
});
---

<BaseLayout title={title} description={description}>
    <div class="min-h-screen bg-[#E4E4E4]">
        <!-- Main content container - single column for posts -->
        <div class="max-w-[780px] mx-auto bg-white">
            <article
                class="px-4 py-6 md:px-8 md:py-8 lg:px-10 lg:py-10 bg-white"
            >
                <!-- Post Header -->
                <header
                    class="mb-6 md:mb-8 pb-4 md:pb-6 border-b border-[#ddd]"
                >
                    <h1
                        class="text-2xl md:text-3xl lg:text-4xl font-bold mb-3 md:mb-4 leading-tight"
                        style="color: #00473F; font-family: Tahoma, Verdana, Arial, Helvetica, sans-serif; letter-spacing: -0.5px;"
                    >
                        {title}
                    </h1>

                    <!-- Post meta information -->
                    <div
                        class="flex flex-wrap gap-2 md:gap-4 text-sm text-[#666666] mb-3"
                    >
                        {
                            author && (
                                <span>
                                    by{" "}
                                    <strong class="text-[#00473F]">
                                        {author}
                                    </strong>
                                </span>
                            )
                        }

                        <time
                            datetime={date.toISOString()}
                            class="text-[#666666]"
                        >
                            {formattedDate}
                        </time>

                        {
                            category && (
                                <span>
                                    <a
                                        href={`/blog/category/${category}/`}
                                        class="text-[#98A100] hover:text-[#cc3300] hover:underline"
                                    >
                                        {category}
                                    </a>
                                </span>
                            )
                        }
                    </div>

                    <!-- Tags if present -->
                    {
                        tags && tags.length > 0 && (
                            <div class="text-sm text-[#666666]">
                                <span class="mr-2">Tags:</span>
                                {tags.map((tag: string, index: number) => (
                                    <>
                                        <a
                                            href={`/blog/tag/${tag}/`}
                                            class="text-[#98A100] hover:text-[#cc3300] hover:underline"
                                        >
                                            {tag}
                                        </a>
                                        {index < tags.length - 1 && (
                                            <span>, </span>
                                        )}
                                    </>
                                ))}
                            </div>
                        )
                    }
                </header>

                <!-- Post Content with Tailwind Typography -->
                <div
                    class="prose prose-base md:prose-base lg:prose-lg
                        prose-teal
                        max-w-none
                        /* Heritage color customizations */
                        prose-headings:font-[Tahoma,Verdana,Arial,sans-serif]
                        prose-headings:text-[#565656]
                        prose-h2:text-xl prose-h2:md:text-2xl prose-h2:lg:text-3xl
                        prose-h2:mt-8 prose-h2:mb-4
                        prose-h2:pb-2 prose-h2:border-b prose-h2:border-[#eee]
                        prose-h3:text-lg prose-h3:md:text-xl prose-h3:lg:text-2xl
                        prose-h3:mt-6 prose-h3:mb-3
                        prose-p:text-[#333333]
                        prose-p:leading-relaxed
                        prose-p:my-4
                        prose-a:text-[#00473F]
                        prose-a:no-underline
                        hover:prose-a:text-[#cc3300]
                        hover:prose-a:underline
                        prose-strong:text-[#333333]
                        prose-strong:font-bold
                        prose-ul:my-4
                        prose-ol:my-4
                        prose-li:my-1
                        prose-blockquote:border-l-[#98A100]
                        prose-blockquote:bg-[#f8f8f8]
                        prose-blockquote:py-2
                        prose-blockquote:px-4
                        prose-blockquote:italic
                        prose-code:text-[#00473F]
                        prose-code:bg-[#f2f2f2]
                        prose-code:px-1
                        prose-code:py-0.5
                        prose-code:rounded
                        prose-code:before:content-['']
                        prose-code:after:content-['']
                        prose-pre:bg-[#f2f2f2]
                        prose-pre:border
                        prose-pre:border-[#ddd]
                        prose-img:my-6"
                    style="font-family: Tahoma, Verdana, Arial, Helvetica, sans-serif;"
                >
                    <slot />
                </div>

                <!-- Post Footer -->
                <footer class="mt-8 md:mt-12 pt-6 border-t border-[#ddd]">
                    <!-- Navigation to other posts -->
                    <nav
                        class="flex flex-col md:flex-row justify-between gap-4 text-sm"
                    >
                        <div class="flex-1">
                            <span class="text-[#666666] block mb-1"
                                >Previous Post</span
                            >
                            <!-- This would be dynamically populated -->
                        </div>
                        <div class="flex-1 text-right">
                            <span class="text-[#666666] block mb-1"
                                >Next Post</span
                            >
                            <!-- This would be dynamically populated -->
                        </div>
                    </nav>
                </footer>
            </article>
        </div>
    </div>
</BaseLayout>

<style>
    /* Force prose content to fill its container */
    :global(.prose) {
        max-width: 100%;
    }

    /* Custom heritage image styling for all images in content */
    :global(.prose img) {
        padding: 4px;
        border: 1px solid #ccc;
        background: #f8f8ff;
        border-radius: 0;
        width: 100%;
    }

    /* Ensure visited links get the heritage color */
    :global(.prose a:visited) {
        color: #cc9966;
    }

    /* Mobile-first responsive adjustments */
    @media (max-width: 640px) {
        :global(.prose) {
            font-size: 18px;
            line-height: 1.9;
        }

        :global(.prose p) {
            margin-top: 1rem;
            margin-bottom: 1rem;
        }

        :global(.prose h2) {
            font-size: 1.5rem;
            margin-top: 1.75rem;
        }

        :global(.prose h3) {
            font-size: 1.25rem;
            margin-top: 1.5rem;
        }
    }

    /* Desktop enhancements for better readability */
    @media (min-width: 1024px) {
        :global(.prose) {
            font-size: 16px;
            line-height: 1.8;
        }

        :global(.prose p) {
            margin-top: 1.25rem;
            margin-bottom: 1.25rem;
        }
    }

    /* Print styles */
    @media print {
        :global(.prose) {
            max-width: 100%;
            font-size: 12pt;
        }

        nav,
        footer {
            display: none;
        }
    }
</style>
