---
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
// Get only featured pictures
const featuredPictures = await getCollection(
    "pictures",
    ({ data }) => !data.draft && data.featured,
);

// Select a random featured picture if any exist
let picture = null;
if (featuredPictures.length > 0) {
    const randomIndex = Math.floor(Math.random() * featuredPictures.length);
    picture = featuredPictures[randomIndex];
}
---

{
    picture && (
        <section class="mb-8">
            <div class="border border-blue-100 p-2">
                <div class="bg-gray-100 flex items-center justify-center mb-2">
                    <a
                        href={`/pictures/${picture.data.gallery}/${picture.id.split("/").pop()?.replace(".md", "")}/`}
                        title={picture.data.title}
                    >
                        <Image
                            src={picture.data.image}
                            alt={picture.data.title}
                            class="max-h-full max-w-full object-contain border border-gray-300 p-1 bg-gray-50 hover:opacity-90 transition-opacity cursor-pointer heritage-image"
                            loading="lazy"
                        />
                    </a>
                </div>
                <p class="text-sm md:text-xs">
                    <strong>{picture.data.title}:</strong>
                    From the{" "}
                    <a
                        href={`/pictures/${picture.data.gallery}/`}
                        class="text-teal-600 hover:underline"
                    >
                        {picture.data.gallery}
                    </a>{" "}
                    gallery.
                </p>
            </div>
        </section>
    )
}
